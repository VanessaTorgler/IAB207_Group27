{% extends "base.html" %}
{% block title %}
<title>Bondra – Create / Update Event</title>
{% endblock %}


{% block header_inner %}
    <h1 class="h3 mb-1">Create or Update an Event</h1>
    <p class="text-muted mb-0">Add details, upload an image, and publish. Fields marked * are required.</p>
{% endblock %}
{% block content %}

<main class="container py-4">
  <form id="eventForm" class="row g-4" method="POST" enctype="multipart/form-data">
    {{ form.csrf_token }}
    {{ form.hidden_tag() }}
    <!-- Left column -->
    <div class="col-12 col-lg-8">
      <div class="card">
        <div class="card-header fw-semibold">Event details</div>
        <div class="card-body">
          {% if form.errors %}
          <div class="mb-3">
            <div class="alert alert-danger" role="alert">
              Please correct the errors below.
              <ul class="errors">
                {% for field_name, error_list in form.errors.items() %}
                {% for error in error_list %}
                <li>{{ error }}</li>
                {% endfor %}
                {% endfor %}
              </ul>
            </div>
          </div>
          {% endif %}
          <div class="mb-3">
            <label for="title" class="form-label">Title</label>
            <input id="title" name="title" type="text" value="{{ form.title.data }}" class="form-control" required
              placeholder="e.g., Founders’ Breakfast: AI in Practice">
          </div>

          <div class="mb-3">
            {{ form.description.label(class="form-label") }}
            {{ form.description(class="form-control", rows="5", placeholder="What is the event about? Who should attend?") }}
            
          </div>

          <div class="row g-3">
            <div class="col-12 col-md-6">
              <label for="category" class="form-label">Category</label>
              <select id="category" name="category" class="form-select" required>
                {% for value, label in form.category.choices %}
                <option value="{{ value }}" {% if form.category.data==value %}selected{% endif %}>
                  {{ label }}
                </option>
                {% endfor %}
              </select>
            </div>
            <div class="col-12 col-md-6">
              <label for="format" class="form-label">Format</label>
              <select id="format" name="format" class="form-select" required>
                {% for value, label in form.format.choices %}
                <option value="{{ value }}" {% if form.format.data==value %}selected{% endif %}>
                  {{ label }}
                </option>
                {% endfor %}
              </select>
            </div>
          </div>

          <div class="row g-3 mt-0">
            <div class="col-12 col-md-6">
              <label for="date" class="form-label">Date</label>
              <input id="date" type="date" name="date"
                value="{{ form.date.data.strftime('%Y-%m-%d') if form.date.data else '' }}" class="form-control"
                required>

            </div>
            <div class="col-6 col-md-3">
              <label for="start" class="form-label">Start time</label>
              <input id="start" type="time" name="start_time"
                value="{{ form.start_time.data.strftime('%H:%M') if form.start_time.data else '' }}"
                class="form-control" required>
            </div>
            <div class="col-6 col-md-3">
              <label for="end" class="form-label">End time</label>
              <input id="end" type="time" name="end_time"
                value="{{ form.end_time.data.strftime('%H:%M') if form.end_time.data else '' }}" class="form-control"
                required>
            </div>
          </div>
          <div class="row g-3 mt-0">
            <div class="col-12 col-md-8">
              <label for="venue" class="form-label">Location / Venue</label>
              <input id="venue" name="location" type="text" value="{{ form.location.data }}" class="form-control"
                required placeholder="e.g., Brisbane CBD, Level 2, 123 Adelaide St">
            </div>
            <div class="col-12 col-md-4">
              <label for="capacity" class="form-label">Capacity</label>
              <input id="capacity" name="capacity" type="number" value="{{ form.capacity.data }}" min="1" step="1"
                class="form-control" required placeholder="e.g., 30">
            </div>
          </div>

          <div class="mt-3">
            <label for="image" class="form-label">Event image {% if is_create %}{% endif %}</label>
            <input id="image" name="event_image" type="file" value="{{ form.event_image.data }}" class="form-control"
              accept="image/*" {% if is_create %}required{% endif %}>
            <div class="form-text">JPEG/PNG recommended. Appears on the event card and details page.</div>
          </div>
          <div class="mt-3">
            <label for="imageAlt" class="form-label">Image alt text</label>
            <input id="imageAlt" name="image_alt_text" type="text" value="{{ form.image_alt_text.data }}"
              class="form-control" placeholder="Describe the image for screen readers">
          </div>
        </div>
      </div>

      <div class="card mt-4">
        <div class="card-header fw-semibold">Tickets & Pricing</div>
        <div class="card-body">
          <div class="row g-3">
            <div class="col-12 col-md-4">
              <label for="price" class="form-label">Ticket price (AUD)</label>
              <input id="price" name="ticket_price" type="number" value="{{ form.ticket_price.data }}"
                class="form-control" required min="0" step="0.01" placeholder="e.g., 25.00">
              <div class="form-text">If $0, event will be listed as Free.</div>
            </div>
            <div class="col-12 col-md-4">
              <label for="rsvpClose" class="form-label">RSVP closes</label>
              <input id="rsvpClose" name="rsvp_closes" value="{{ form.rsvp_closes.data }}" type="datetime-local"
                class="form-control" required>
            </div>
          </div>
        </div>
      </div>


      <div class="card mt-4">
        <div class="card-header fw-semibold">Host & contact</div>
        <div class="card-body">
          <div class="row g-3">
            <div class="col-12 col-md-6">
              <label for="host" class="form-label">Host/Organisation</label>
              <input id="host" name="host_name" value="{{ form.host_name.data }}" type="text" class="form-control"
                required placeholder="e.g., Brisbane Startups Collective">
            </div>
            <div class="col-12 col-md-6">
              <label for="contact" class="form-label">Contact email</label>
              <input id="contact" name="host_contact" value="{{ form.host_contact.data }}" type="email"
                class="form-control" required placeholder="support@foundersbreakfast.com">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right column -->
    <aside class="col-12 col-lg-4">
      <div class="card">
        <div class="card-header fw-semibold">Publish</div>
        <div class="card-body">
          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary" form="eventForm">
              Publish
            </button>
            <button type="reset" class="btn btn-outline-secondary">Reset</button>
          </div>
        </div>
      </div>
    </aside>
  </form>
</main>
{% endblock %}
